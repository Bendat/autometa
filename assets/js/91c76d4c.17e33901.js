"use strict";(self.webpackChunk_autometa_documentation=self.webpackChunk_autometa_documentation||[]).push([[960],{4993:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>k});var a=n(2983);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),s=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(u.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(n),c=r,k=d["".concat(u,".").concat(c)]||d[c]||m[c]||l;return n?a.createElement(k,o(o({ref:t},p),{},{components:n})):a.createElement(k,o({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=c;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2396:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var a=n(3050),r=(n(2983),n(4993));const l={sidebar_position:3},o="CLI Reference",i={unversionedId:"reference/cli",id:"reference/cli",title:"CLI Reference",description:"The @autometa/cli package provides the autometa command-line tool for running your tests.",source:"@site/docs/reference/cli.md",sourceDirName:"reference",slug:"/reference/cli",permalink:"/autometa/docs/v1.0.0-rc.5/reference/cli",draft:!1,editUrl:"https://github.com/Bendat/autometa/tree/main/documentation/website/docs/reference/cli.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"reference",previous:{title:"API Reference",permalink:"/autometa/docs/v1.0.0-rc.5/reference/api"},next:{title:"Events (test listeners)",permalink:"/autometa/docs/v1.0.0-rc.5/reference/events"}},u={},s=[{value:"<code>autometa run</code>",id:"autometa-run",level:2},{value:"Arguments",id:"arguments",level:3},{value:"Options",id:"options",level:3},{value:"Groups &amp; Modules",id:"groups--modules",level:3},{value:"Examples",id:"examples",level:3},{value:"Config discovery, global installs, and custom names",id:"config-discovery-global-installs-and-custom-names",level:3},{value:"Runner detection and modes",id:"runner-detection-and-modes",level:3},{value:"Cache directory configuration",id:"cache-directory-configuration",level:3}],p={toc:s},d="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"cli-reference"},"CLI Reference"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"@autometa/cli")," package provides the ",(0,r.kt)("inlineCode",{parentName:"p"},"autometa")," command-line tool for running your tests."),(0,r.kt)("h2",{id:"autometa-run"},(0,r.kt)("inlineCode",{parentName:"h2"},"autometa run")),(0,r.kt)("p",null,"Executes your feature files."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run [options] [patterns...]\n")),(0,r.kt)("h3",{id:"arguments"},"Arguments"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"patterns"),": Optional glob patterns to filter which feature files to run. If omitted, it uses the ",(0,r.kt)("inlineCode",{parentName:"li"},"roots.features")," from your configuration.")),(0,r.kt)("h3",{id:"options"},"Options"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--config <path>")),(0,r.kt)("td",{parentName:"tr",align:null},"Path to the configuration file (overrides discovery).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-e, --environment <environment>")),(0,r.kt)("td",{parentName:"tr",align:null},"Select a named environment from ",(0,r.kt)("inlineCode",{parentName:"td"},"environments")," in your config.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-g, --group <group>")),(0,r.kt)("td",{parentName:"tr",align:null},"Filter module groups to include (affects module/step loading; patterns are not auto-scoped). Repeatable.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-m, --module <module>")),(0,r.kt)("td",{parentName:"tr",align:null},"Filter modules to include (by id or unambiguous suffix; affects module/step loading; patterns are not auto-scoped). Repeatable.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--dry-run")),(0,r.kt)("td",{parentName:"tr",align:null},"Compiles the features and steps but does not execute the scenarios. Useful for checking for undefined steps.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--watch")),(0,r.kt)("td",{parentName:"tr",align:null},"Runs in watch mode. Only supported when using a native runner (Jest/Vitest).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--standalone")),(0,r.kt)("td",{parentName:"tr",align:null},"Forces the use of the built-in CLI runtime, bypassing Jest/Vitest even if configured.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--verbose")),(0,r.kt)("td",{parentName:"tr",align:null},"Enables verbose logging.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--cache-dir <dir>")),(0,r.kt)("td",{parentName:"tr",align:null},"Directory for the Autometa cache (defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"node_modules/.cache/autometa")," when available).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"--handover")),(0,r.kt)("td",{parentName:"tr",align:null},"Pass args after ",(0,r.kt)("inlineCode",{parentName:"td"},"--")," directly to the detected native runner (vitest/jest/playwright).")))),(0,r.kt)("h3",{id:"groups--modules"},"Groups & Modules"),(0,r.kt)("p",null,"Autometa can model monorepo-style suites using ",(0,r.kt)("strong",{parentName:"p"},"groups")," (e.g. apps) and ",(0,r.kt)("strong",{parentName:"p"},"modules")," (e.g. use-cases/bounded contexts)."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Groups")," select which step environments (world + app) are eligible to run a feature (via ",(0,r.kt)("inlineCode",{parentName:"li"},'CucumberRunner.builder().group("...")'),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Modules")," are an optional config feature (",(0,r.kt)("inlineCode",{parentName:"li"},"modules.relativeRoots"),") that expands roots and allows targeted runs via ",(0,r.kt)("inlineCode",{parentName:"li"},"-m/-g"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"See ",(0,r.kt)("a",{parentName:"li",href:"/autometa/docs/v1.0.0-rc.5/getting-started/monorepos"},"Getting Started \u2192 Monorepos")," for recommended layouts.")))),(0,r.kt)("p",null,"Module selectors accepted by ",(0,r.kt)("inlineCode",{parentName:"p"},"-m"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Exact: ",(0,r.kt)("inlineCode",{parentName:"li"},"<group>/<modulePath>")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"<group>:<modulePath>")," (deep paths supported)"),(0,r.kt)("li",{parentName:"ul"},"Suffix: ",(0,r.kt)("inlineCode",{parentName:"li"},"<modulePath>")," (must be unambiguous; use ",(0,r.kt)("inlineCode",{parentName:"li"},"-g")," to disambiguate)")),(0,r.kt)("p",null,"Feature scoping for step visibility (when ",(0,r.kt)("inlineCode",{parentName:"p"},'modules.stepScoping: "scoped"'),"):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Features under a group/module directory are scoped by their file path."),(0,r.kt)("li",{parentName:"ul"},"Hoisted features can opt into a scope via ",(0,r.kt)("inlineCode",{parentName:"li"},"@scope(<group>:<modulePath>)")," (example: ",(0,r.kt)("inlineCode",{parentName:"li"},"@scope(backoffice:reports)"),").",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Hoisted scoping behavior is configurable via ",(0,r.kt)("inlineCode",{parentName:"li"},"modules.hoistedFeatures.scope"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"tag"')," (default): hoisted features require ",(0,r.kt)("inlineCode",{parentName:"li"},"@scope(...)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"directory"'),": infer scope from the feature\u2019s directory under ",(0,r.kt)("inlineCode",{parentName:"li"},"roots.features")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@scope(<group>)")," assigns the feature to the group, but does not intentionally downgrade a module-inferred scope for features already under a module directory.")))),(0,r.kt)("h3",{id:"examples"},"Examples"),(0,r.kt)("p",null,"Run all features:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run\n")),(0,r.kt)("p",null,"Run specific features:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'autometa run "features/user/*.feature"\n')),(0,r.kt)("p",null,"Run in watch mode (with Vitest/Jest):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run --watch\n")),(0,r.kt)("p",null,"Force standalone mode:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run --standalone\n")),(0,r.kt)("p",null,"Select an environment:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run -e staging\n")),(0,r.kt)("p",null,"Run a group:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run -g backoffice\n")),(0,r.kt)("p",null,"Run a module (unambiguous suffix):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run -g backoffice -m reports\n")),(0,r.kt)("p",null,"Run a deep module (exact id):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run -m backoffice:orders:cancellations\n")),(0,r.kt)("p",null,"Forward Playwright args to the native runner:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"autometa run --handover -- --project=api --headed\n")),(0,r.kt)("h3",{id:"config-discovery-global-installs-and-custom-names"},"Config discovery, global installs, and custom names"),(0,r.kt)("p",null,"The CLI locates your config by searching upward from the current directory for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"autometa.config.{ts,mts,cts,js,mjs,cjs}")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"autometa.<name>.config.{ts,mts,cts,js,mjs,cjs}")," (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"autometa.e2e.config.ts"),")")),(0,r.kt)("p",null,"This works well with globally installed CLIs or when you run from a subfolder. Use ",(0,r.kt)("inlineCode",{parentName:"p"},"--config")," to point at a specific file when you keep multiple configs."),(0,r.kt)("h3",{id:"runner-detection-and-modes"},"Runner detection and modes"),(0,r.kt)("p",null,"If ",(0,r.kt)("inlineCode",{parentName:"p"},"runner")," is not explicitly set (or set to ",(0,r.kt)("inlineCode",{parentName:"p"},"auto"),"-like behavior), the CLI detects a native runner based on project files:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Vitest: presence of ",(0,r.kt)("inlineCode",{parentName:"li"},"vitest.config.*")),(0,r.kt)("li",{parentName:"ul"},"Jest: presence of ",(0,r.kt)("inlineCode",{parentName:"li"},"jest.config.*")),(0,r.kt)("li",{parentName:"ul"},"Playwright: presence of ",(0,r.kt)("inlineCode",{parentName:"li"},"playwright.config.*"))),(0,r.kt)("p",null,"Modes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Default ("native"/"auto"): delegate to the detected runner when available'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--standalone"),": use the built-in runtime regardless of native runner presence")),(0,r.kt)("h3",{id:"cache-directory-configuration"},"Cache directory configuration"),(0,r.kt)("p",null,"The CLI compiles TS modules (e.g., configs) into a cache directory. Defaults:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"node_modules/.cache/autometa")," when ",(0,r.kt)("inlineCode",{parentName:"li"},"node_modules")," is present"),(0,r.kt)("li",{parentName:"ul"},"OS cache fallback otherwise")),(0,r.kt)("p",null,"You can override via environment variables:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"AUTOMETA_CACHE_DIR")," \u2013 absolute or relative path to use as the cache dir"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"AUTOMETA_HOME")," \u2013 base directory; the CLI writes a ",(0,r.kt)("inlineCode",{parentName:"li"},"cache/")," subfolder under it")))}m.isMDXComponent=!0}}]);