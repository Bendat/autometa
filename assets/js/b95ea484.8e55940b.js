"use strict";(self.webpackChunk_autometa_documentation=self.webpackChunk_autometa_documentation||[]).push([[3488],{4993:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(2983);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=a,f=c["".concat(s,".").concat(m)]||c[m]||d[m]||i;return n?r.createElement(f,o(o({ref:t},p),{},{components:n})):r.createElement(f,o({ref:t},p))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6414:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var r=n(3050),a=(n(2983),n(4993));const i={sidebar_position:2},o="API Reference",l={unversionedId:"reference/api",id:"reference/api",title:"API Reference",description:"CucumberRunner",source:"@site/docs/reference/api.md",sourceDirName:"reference",slug:"/reference/api",permalink:"/autometa/docs/v1.0.0-rc.4/reference/api",draft:!1,editUrl:"https://github.com/Bendat/autometa/tree/main/documentation/website/docs/reference/api.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"reference",previous:{title:"Configuration reference",permalink:"/autometa/docs/v1.0.0-rc.4/reference/configuration"},next:{title:"CLI Reference",permalink:"/autometa/docs/v1.0.0-rc.4/reference/cli"}},s={},u=[{value:"CucumberRunner",id:"cucumberrunner",level:2},{value:"<code>CucumberRunner.builder()</code>",id:"cucumberrunnerbuilder",level:3},{value:"<code>RunnerBuilder</code> Methods",id:"runnerbuilder-methods",level:3},{value:"<code>.withWorld(factory)</code>",id:"withworldfactory",level:4},{value:"<code>.app(compositionRoot)</code>",id:"appcompositionroot",level:4},{value:"<code>.assertionPlugins(plugins)</code>",id:"assertionpluginsplugins",level:4},{value:"<code>.parameterTypes(definitions)</code>",id:"parametertypesdefinitions",level:4},{value:"<code>.steps()</code>",id:"steps",level:4},{value:"<code>.bindingsTS()</code>",id:"bindingsts",level:4},{value:"DtoBuilder",id:"dtobuilder",level:2},{value:"<code>DtoBuilder.forInterface&lt;T&gt;(options)</code>",id:"dtobuilderforinterfacetoptions",level:3},{value:"<code>DtoBuilder.forClass(constructor, options)</code>",id:"dtobuilderforclassconstructor-options",level:3},{value:"ensure",id:"ensure",level:2},{value:"Built-in Assertions",id:"built-in-assertions",level:3},{value:"StepRuntimeHelpers (docstrings, tables, metadata)",id:"stepruntimehelpers-docstrings-tables-metadata",level:2}],p={toc:u},c="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"api-reference"},"API Reference"),(0,a.kt)("h2",{id:"cucumberrunner"},"CucumberRunner"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"CucumberRunner")," class is the entry point for configuring your test environment. It uses a builder pattern to compose your world, application, and assertion plugins."),(0,a.kt)("h3",{id:"cucumberrunnerbuilder"},(0,a.kt)("inlineCode",{parentName:"h3"},"CucumberRunner.builder()")),(0,a.kt)("p",null,"Creates a new ",(0,a.kt)("inlineCode",{parentName:"p"},"RunnerBuilder")," instance."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { CucumberRunner } from "@autometa/runner";\n\nconst runner = CucumberRunner.builder();\n')),(0,a.kt)("h3",{id:"runnerbuilder-methods"},(0,a.kt)("inlineCode",{parentName:"h3"},"RunnerBuilder")," Methods"),(0,a.kt)("h4",{id:"withworldfactory"},(0,a.kt)("inlineCode",{parentName:"h4"},".withWorld(factory)")),(0,a.kt)("p",null,"Defines the world factory used to create worlds for execution scopes."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"factory"),": A function or class that returns the world object."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Returns"),": A new builder instance typed with the new world.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"runner.withWorld(() => ({ count: 0 }));\n")),(0,a.kt)("p",null,"Notes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A fresh ",(0,a.kt)("strong",{parentName:"li"},"scenario world")," is always created per scenario."),(0,a.kt)("li",{parentName:"ul"},"Autometa may also create ",(0,a.kt)("strong",{parentName:"li"},"feature/rule/scenario-outline")," worlds when you register hooks for those scopes (",(0,a.kt)("inlineCode",{parentName:"li"},"BeforeFeature"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"BeforeRule"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"BeforeScenarioOutline"),", etc.)."),(0,a.kt)("li",{parentName:"ul"},"When a higher-scope world exists, the next nested scope receives it as ",(0,a.kt)("inlineCode",{parentName:"li"},"context.parent")," in your world factory.")),(0,a.kt)("p",null,"If you want selected values copied from the parent world into the child world, opt-in via ",(0,a.kt)("inlineCode",{parentName:"p"},"WORLD_INHERIT_KEYS"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { WORLD_INHERIT_KEYS } from "@autometa/runner";\n\nrunner.withWorld({\n  baseUrl: "",\n  [WORLD_INHERIT_KEYS]: ["baseUrl"],\n});\n')),(0,a.kt)("h4",{id:"appcompositionroot"},(0,a.kt)("inlineCode",{parentName:"h4"},".app(compositionRoot)")),(0,a.kt)("p",null,"Registers an application composition root. This is useful for dependency injection and managing shared services."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"compositionRoot"),": A class or factory function that creates your application container."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Returns"),": A new builder instance where the world has an ",(0,a.kt)("inlineCode",{parentName:"li"},"app")," property.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"runner.app(CompositionRoot);\n")),(0,a.kt)("h4",{id:"assertionpluginsplugins"},(0,a.kt)("inlineCode",{parentName:"h4"},".assertionPlugins(plugins)")),(0,a.kt)("p",null,"Registers custom assertion plugins for ",(0,a.kt)("inlineCode",{parentName:"p"},"ensure(...)"),"."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"plugins"),": An object where keys are plugin names and values are plugin factories."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Returns"),": A new builder instance with the plugins available on ",(0,a.kt)("inlineCode",{parentName:"li"},"ensure"),".")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'runner.assertionPlugins({\n  myPlugin: (world) => (actual) => ({\n    toBeAwesome: () => console.log(actual, "is awesome"),\n  }),\n});\n')),(0,a.kt)("h4",{id:"parametertypesdefinitions"},(0,a.kt)("inlineCode",{parentName:"h4"},".parameterTypes(definitions)")),(0,a.kt)("p",null,"Registers custom Cucumber parameter types."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"definitions"),": A function that receives a ",(0,a.kt)("inlineCode",{parentName:"li"},"defineParameterType")," helper.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'runner.parameterTypes((define) => {\n  define({\n    name: "color",\n    regexp: /red|blue|green/,\n    transformer: (s) => s.toUpperCase(),\n  });\n});\n')),(0,a.kt)("h4",{id:"steps"},(0,a.kt)("inlineCode",{parentName:"h4"},".steps()")),(0,a.kt)("p",null,"Finalizes the configuration and returns the steps environment. This object contains ",(0,a.kt)("inlineCode",{parentName:"p"},"Given"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"When"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"Then"),", hooks, and ",(0,a.kt)("inlineCode",{parentName:"p"},"ensure"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"export const { Given, When, Then } = runner.steps();\n")),(0,a.kt)("h4",{id:"bindingsts"},(0,a.kt)("inlineCode",{parentName:"h4"},".bindingsTS()")),(0,a.kt)("p",null,"Returns the decorator-based environment for use with TypeScript experimental decorators."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"export const { Binding, Given, When, Then } = runner.bindingsTS();\n")),(0,a.kt)("h2",{id:"dtobuilder"},"DtoBuilder"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"DtoBuilder")," provides a fluent interface for creating test data objects (DTOs) with default values and overrides."),(0,a.kt)("h3",{id:"dtobuilderforinterfacetoptions"},(0,a.kt)("inlineCode",{parentName:"h3"},"DtoBuilder.forInterface<T>(options)")),(0,a.kt)("p",null,"Creates a builder factory for an interface."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"options"),":",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"defaults"),": An object defining default values or factories for properties.")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { DtoBuilder } from "@autometa/dto-builder";\n\ninterface User {\n  id: string;\n  name: string;\n}\n\nconst userBuilder = DtoBuilder.forInterface<User>({\n  defaults: {\n    id: () => crypto.randomUUID(),\n    name: "Anonymous",\n  },\n});\n\nconst user = userBuilder.create().name("Alice").build();\n')),(0,a.kt)("h3",{id:"dtobuilderforclassconstructor-options"},(0,a.kt)("inlineCode",{parentName:"h3"},"DtoBuilder.forClass(constructor, options)")),(0,a.kt)("p",null,"Creates a builder factory for a class. It respects ",(0,a.kt)("inlineCode",{parentName:"p"},"@Builder")," decorators on the class."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"constructor"),": The class constructor."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"options"),": Same as ",(0,a.kt)("inlineCode",{parentName:"li"},"forInterface"),".")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"class User {\n  id: string;\n  name: string;\n}\n\nconst userBuilder = DtoBuilder.forClass(User);\n")),(0,a.kt)("h2",{id:"ensure"},"ensure"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"ensure")," function is the entry point for assertions. It can be extended with plugins."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { ensure } from "./step-definitions";\n\nensure(value).toBe(expected);\n')),(0,a.kt)("h3",{id:"built-in-assertions"},"Built-in Assertions"),(0,a.kt)("p",null,"(List some common assertions here if available, or link to ",(0,a.kt)("inlineCode",{parentName:"p"},"@autometa/assertions")," docs if they exist separately)"),(0,a.kt)("h2",{id:"stepruntimehelpers-docstrings-tables-metadata"},"StepRuntimeHelpers (docstrings, tables, metadata)"),(0,a.kt)("p",null,"Steps can access runtime helpers via ",(0,a.kt)("inlineCode",{parentName:"p"},"world.runtime"),", which provides access to docstrings, tables, and step metadata."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { Given } from "./step-definitions";\n\nGiven("the request payload is defined", (world) => {\n  world.state.payload = world.runtime.consumeDocstringTransformed();\n});\n')),(0,a.kt)("p",null,"Docstring media types (text block types) are preserved and can be transformed via ",(0,a.kt)("inlineCode",{parentName:"p"},"configureStepDocstrings"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { configureStepDocstrings } from "@autometa/runner";\n\nconfigureStepDocstrings({\n  transformers: {\n    json: (raw) => JSON.parse(raw),\n  },\n});\n')),(0,a.kt)("p",null,"Full reference and examples: see ",(0,a.kt)("inlineCode",{parentName:"p"},"documentation/website/docs/reference/step-runtime.md:1"),"."))}d.isMDXComponent=!0}}]);